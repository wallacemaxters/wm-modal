angular.module("wm.modal",[]).directive("wmModal",function(){return{restrict:"EA",transclude:true,replace:true,template:'<div class="wm-modal closing"><div class="modal-container" ng-class="containerClass" ng-style="{height: modalHeight, width: modalWidth, \'z-index\' : zIndex}" ng-click="$event.stopPropagation()" ng-transclude></div></div>',scope:{modalHeight:"@",modalWidth:"@",containerClass:"@",zIndex:"@"}};
}).service("$wmModal",["$compile","$document","$rootScope","$timeout","$controller","$q","$window",function(f,e,i,c,a,g,b){var d=[];var h=function(j){var m,n,o,l,k,p;
j=angular.isObject(j)?j:{};n=this;n.closed=false;m=angular.element("<wm-modal></wm-modal>");k={result:g.defer()};n.result=k.result.promise;p=angular.extend;
o=function(){if(n.closed){return;}m.addClass("closing");c(function(){m.remove();},200);l.$destroy();n.closed=true;};n.open=function(){l=p(i.$new(),j.scope);
if(j.controller){var s,q;s=p({$scope:l,$wmModalInstance:n},j.locals);q=a(j.controller,s);angular.isString(j.controller)&&j.controller.indexOf(" as ")>=0&&p(q,j.scope);
}m.attr({"container-class":j.containerClass,"modal-height":j.height,"modal-width":j.width,"z-index":n.zIndex,});if(j.templateUrl){var r=angular.element("<div></div>").attr({"ng-include":"'"+j.templateUrl+"'"});
m.append(r);}else{if(j.template){m.append(j.template);}}m=f(m)(l);j.clickout&&m.on("click",function(){n.cancel();});e.find("body").append(m);c(function(){m.removeClass("closing");
});return n;};n.close=function(){o.call(n);k.result.resolve();return n;};n.cancel=function(){o.call(n);k.result.reject();return n;};};angular.element(b).bind("keyup",function(k){if(k.which===27){var j=d[d.length-1];
j&&j.cancel();}});return{open:function(j){var l=this;var k=new h(j);k.zIndex=this.zIndex++;k.open();d.push(k);k.result["finally"](function(){d.pop();--this.zIndex;
});return k;},zIndex:1000};}]);