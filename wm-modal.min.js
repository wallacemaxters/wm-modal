angular.module("wm.modal",[]).directive("wmModal",function(){return{restrict:"EA",transclude:true,replace:true,template:'<div class="wm-modal closing"><div class="modal-container" ng-class="containerClass" ng-style="{height: modalHeight, width: modalWidth, \'z-index\' : zIndex}" ng-click="$event.stopPropagation()" ng-transclude></div></div>',scope:{modalHeight:"@",modalWidth:"@",containerClass:"@",zIndex:"@"}};
}).service("$wmModal",["$compile","$document","$rootScope","$timeout","$controller","$q","$window",function(f,e,i,c,a,g,b){var d=[];var h=function(k){var m,n,o,l,j;
k=angular.isObject(k)?k:{};n=this;n.closed=false;m=angular.element("<wm-modal></wm-modal>");j=g.defer();n.result=j.promise;n.scope=i.$new();n.$$close=function(){if(n.closed){return;
}m.addClass("closing");c(function(){m.remove();},200);n.closed=true;n.scope.$destroy();};n.open=function(){n.scope.$modal=n;if(k.controller){var r,p;r=angular.extend({$scope:n.scope,$wmModalInstance:n},k.locals);
p=a(k.controller,r);if(angular.isString(k.controller)&&k.controller.indexOf(" as ")>=0){p.$modal=n;}}m.attr({"container-class":k.containerClass,"modal-height":k.height,"modal-width":k.width,"z-index":n.zIndex,});
if(k.templateUrl){var q=angular.element("<div></div>").attr({"ng-include":"'"+k.templateUrl+"'"});m.append(q);}else{if(k.template){m.append(k.template);
}}m=f(m)(n.scope);k.clickout&&m.on("click",function(s){n.cancel({event:s,type:"backdrop"});});e.find("body").append(m);c(function(){m.removeClass("closing");
});return n;};n.close=function(p){n.$$close.call(n);j.resolve(p);return n;};n.cancel=function(p){n.$$close.call(n);j.reject(p);return n;};};angular.element(b).bind("keyup",function(k){if((k.which||k.keyCode)===27){var j=d[d.length-1];
j&&j.cancel({event:k,type:"esc"});}});return{open:function(j){var l=this;var k=new h(j);k.$$zIndex=this.$$zIndex++;k.open();d.push(k);k.result["finally"](function(){d.pop();
--this.$$zIndex;});return k;},$$zIndex:1000};}]);